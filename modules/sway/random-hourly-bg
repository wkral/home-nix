# vim: filetype=bash

set -e

_term() {
  kill -HUP "$sleep_pid" 2>/dev/null
}

trap _term SIGHUP

papers_dir="$HOME/.config/wallpapers/"
regex='.*\.(jpg|png)$'

while :
do
    bg=$(find $papers_dir -regextype posix-egrep -regex ${regex} | shuf -n 1)
    swaymsg --socket $SWAYSOCK output '*' bg ${bg} fill
    sleep 1h &
    sleep_pid=$!
    wait "$sleep_pid"
done
